[build]
  command = "npm run build"
  publish = "public"

[context.production.environment]
  HUGO_VERSION = "0.36"
  HUGO_ENV = "production"
  NODE_VERSION = "--lts=carbon"

[context.deploy-preview.environment]
  HUGO_VERSION = "0.36"
  NODE_VERSION = "--lts=carbon"

[context.branch-deploy.environment]
  HUGO_VERSION = "0.36"
  NODE_VERSION = "--lts=carbon"

#
# Headers
#
[[headers]]
  for = "/*"
  [headers.values]
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "SAMEORIGIN"
    X-XSS-Protection = "1; mode=block"
    Content-Security-Policy = "default-src 'none'; script-src 'self' https://widget.sndcdn.com https://cdnjs.cloudflare.com https://www.google-analytics.com https://www.googletagmanager.com; style-src 'self' https://cdnjs.cloudflare.com; img-src 'self' data: *; font-src https://cdnjs.cloudflare.com; frame-src https://w.soundcloud.com;"

  for = "/**/*.svg"
  [headers.values]
    Content-Security-Policy = "default-src 'none'; frame-ancestors 'none'; style-src 'self' 'unsafe-inline';";

#
# Redirects
#
[[redirects]]
  from = "/show/*"
  to = "/shows/:splat"
  status = 301

[[redirects]]
  from = "/tnm-extra/*"
  to = "/extras/:splat"
  status = 301
